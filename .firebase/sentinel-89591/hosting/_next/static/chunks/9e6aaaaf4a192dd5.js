(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,58594,e=>{"use strict";var r=e.i(43476),t=e.i(71645),n=e.i(91285);let a=(0,t.forwardRef)(({className:e,size:t="md",...a},o)=>(0,r.jsx)("div",{ref:o,className:(0,n.cn)("animate-spin rounded-full border-2 border-border border-t-primary-500",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[t],e),...a}));a.displayName="Spinner";let o=({text:e="Cargando...",size:t="md",className:o})=>(0,r.jsxs)("div",{className:(0,n.cn)("flex flex-col items-center justify-center gap-2",o),children:[(0,r.jsx)(a,{size:t}),e&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e})]});e.s(["LoadingSpinner",()=>o,"Spinner",()=>a])},18566,(e,r,t)=>{r.exports=e.r(76562)},13741,e=>{"use strict";var r=e.i(43476),t=e.i(71645),n=e.i(54579),a=e.i(59544),o=e.i(58594);function s(){let{signIn:e,loading:s}=(0,n.useAuth)(),[i,l]=(0,t.useState)(!1),c=async()=>{try{l(!0),await e()}catch(e){console.error("Error during login:",e)}finally{l(!1)}};return(0,r.jsxs)(a.Button,{onClick:c,disabled:i||s,className:"flex items-center gap-2",children:[i||s?(0,r.jsx)(o.Spinner,{size:"sm"}):(0,r.jsxs)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),i||s?"Conectando...":"Continuar con Google"]})}e.s(["LoginButton",()=>s])},98183,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={assign:function(){return l},searchParamsToUrlQuery:function(){return o},urlQueryToSearchParams:function(){return i}};for(var a in n)Object.defineProperty(t,a,{enumerable:!0,get:n[a]});function o(e){let r={};for(let[t,n]of e.entries()){let e=r[t];void 0===e?r[t]=n:Array.isArray(e)?e.push(n):r[t]=[e,n]}return r}function s(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let r=new URLSearchParams;for(let[t,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)r.append(t,s(e));else r.set(t,s(n));return r}function l(e,...r){for(let t of r){for(let r of t.keys())e.delete(r);for(let[r,n]of t.entries())e.append(r,n)}return e}},86762,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={formatUrl:function(){return i},formatWithValidation:function(){return c},urlObjectKeys:function(){return l}};for(var a in n)Object.defineProperty(t,a,{enumerable:!0,get:n[a]});let o=e.r(90809)._(e.r(98183)),s=/https?|ftp|gopher|file/;function i(e){let{auth:r,hostname:t}=e,n=e.protocol||"",a=e.pathname||"",i=e.hash||"",l=e.query||"",c=!1;r=r?encodeURIComponent(r).replace(/%3A/i,":")+"@":"",e.host?c=r+e.host:t&&(c=r+(~t.indexOf(":")?`[${t}]`:t),e.port&&(c+=":"+e.port)),l&&"object"==typeof l&&(l=String(o.urlQueryToSearchParams(l)));let u=e.search||l&&`?${l}`||"";return n&&!n.endsWith(":")&&(n+=":"),e.slashes||(!n||s.test(n))&&!1!==c?(c="//"+(c||""),a&&"/"!==a[0]&&(a="/"+a)):c||(c=""),i&&"#"!==i[0]&&(i="#"+i),u&&"?"!==u[0]&&(u="?"+u),a=a.replace(/[?#]/g,encodeURIComponent),u=u.replace("#","%23"),`${n}${c}${a}${u}${i}`}let l=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return i(e)}},18581,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let n=e.r(71645);function a(e,r){let t=(0,n.useRef)(null),a=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=t.current;e&&(t.current=null,e());let r=a.current;r&&(a.current=null,r())}else e&&(t.current=o(e,n)),r&&(a.current=o(r,n))},[e,r])}function o(e,r){if("function"!=typeof e)return e.current=r,()=>{e.current=null};{let t=e(r);return"function"==typeof t?t:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),r.exports=t.default)},18967,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={DecodeError:function(){return x},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return b},NormalizeError:function(){return v},PageNotFoundError:function(){return y},SP:function(){return m},ST:function(){return g},WEB_VITALS:function(){return o},execOnce:function(){return s},getDisplayName:function(){return d},getLocationOrigin:function(){return c},getURL:function(){return u},isAbsoluteUrl:function(){return l},isResSent:function(){return f},loadGetInitialProps:function(){return p},normalizeRepeatedSlashes:function(){return h},stringifyError:function(){return w}};for(var a in n)Object.defineProperty(t,a,{enumerable:!0,get:n[a]});let o=["CLS","FCP","FID","INP","LCP","TTFB"];function s(e){let r,t=!1;return(...n)=>(t||(t=!0,r=e(...n)),r)}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,l=e=>i.test(e);function c(){let{protocol:e,hostname:r,port:t}=window.location;return`${e}//${r}${t?":"+t:""}`}function u(){let{href:e}=window.location,r=c();return e.substring(r.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function f(e){return e.finished||e.headersSent}function h(e){let r=e.split("?");return r[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(r[1]?`?${r.slice(1).join("?")}`:"")}async function p(e,r){let t=r.res||r.ctx&&r.ctx.res;if(!e.getInitialProps)return r.ctx&&r.Component?{pageProps:await p(r.Component,r.ctx)}:{};let n=await e.getInitialProps(r);if(t&&f(t))return n;if(!n)throw Object.defineProperty(Error(`"${d(e)}.getInitialProps()" should resolve to an object. But found "${n}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let m="undefined"!=typeof performance,g=m&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class x extends Error{}class v extends Error{}class y extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class b extends Error{constructor(e,r){super(),this.message=`Failed to load static file for page: ${e} ${r}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function w(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isLocalURL",{enumerable:!0,get:function(){return o}});let n=e.r(18967),a=e.r(52817);function o(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let r=(0,n.getLocationOrigin)(),t=new URL(e,r);return t.origin===r&&(0,a.hasBasePath)(t.pathname)}catch(e){return!1}}},84508,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"errorOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},22016,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={default:function(){return x},useLinkStatus:function(){return y}};for(var a in n)Object.defineProperty(t,a,{enumerable:!0,get:n[a]});let o=e.r(90809),s=e.r(43476),i=o._(e.r(71645)),l=e.r(86762),c=e.r(8372),u=e.r(18581),d=e.r(18967),f=e.r(5550);e.r(33525);let h=e.r(91949),p=e.r(73668),m=e.r(9396);function g(e){return"string"==typeof e?e:(0,l.formatUrl)(e)}function x(r){var t;let n,a,o,[l,x]=(0,i.useOptimistic)(h.IDLE_LINK_STATUS),y=(0,i.useRef)(null),{href:b,as:j,children:w,prefetch:N=null,passHref:k,replace:C,shallow:E,scroll:S,onClick:A,onMouseEnter:M,onTouchStart:T,legacyBehavior:P=!1,onNavigate:z,ref:L,unstable_dynamicOnHover:O,...U}=r;n=w,P&&("string"==typeof n||"number"==typeof n)&&(n=(0,s.jsx)("a",{children:n}));let _=i.default.useContext(c.AppRouterContext),B=!1!==N,D=!1!==N?null===(t=N)||"auto"===t?m.FetchStrategy.PPR:m.FetchStrategy.Full:m.FetchStrategy.PPR,{href:R,as:$}=i.default.useMemo(()=>{let e=g(b);return{href:e,as:j?g(j):e}},[b,j]);if(P){if(n?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});a=i.default.Children.only(n)}let I=P?a&&"object"==typeof a&&a.ref:L,F=i.default.useCallback(e=>(null!==_&&(y.current=(0,h.mountLinkInstance)(e,R,_,D,B,x)),()=>{y.current&&((0,h.unmountLinkForCurrentNavigation)(y.current),y.current=null),(0,h.unmountPrefetchableInstance)(e)}),[B,R,_,D,x]),Z={ref:(0,u.useMergedRef)(F,I),onClick(r){P||"function"!=typeof A||A(r),P&&a.props&&"function"==typeof a.props.onClick&&a.props.onClick(r),!_||r.defaultPrevented||function(r,t,n,a,o,s,l){if("undefined"!=typeof window){let c,{nodeName:u}=r.currentTarget;if("A"===u.toUpperCase()&&((c=r.currentTarget.getAttribute("target"))&&"_self"!==c||r.metaKey||r.ctrlKey||r.shiftKey||r.altKey||r.nativeEvent&&2===r.nativeEvent.which)||r.currentTarget.hasAttribute("download"))return;if(!(0,p.isLocalURL)(t)){o&&(r.preventDefault(),location.replace(t));return}if(r.preventDefault(),l){let e=!1;if(l({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:d}=e.r(99781);i.default.startTransition(()=>{d(n||t,o?"replace":"push",s??!0,a.current)})}}(r,R,$,y,C,S,z)},onMouseEnter(e){P||"function"!=typeof M||M(e),P&&a.props&&"function"==typeof a.props.onMouseEnter&&a.props.onMouseEnter(e),_&&B&&(0,h.onNavigationIntent)(e.currentTarget,!0===O)},onTouchStart:function(e){P||"function"!=typeof T||T(e),P&&a.props&&"function"==typeof a.props.onTouchStart&&a.props.onTouchStart(e),_&&B&&(0,h.onNavigationIntent)(e.currentTarget,!0===O)}};return(0,d.isAbsoluteUrl)($)?Z.href=$:P&&!k&&("a"!==a.type||"href"in a.props)||(Z.href=(0,f.addBasePath)($)),o=P?i.default.cloneElement(a,Z):(0,s.jsx)("a",{...U,...Z,children:n}),(0,s.jsx)(v.Provider,{value:l,children:o})}e.r(84508);let v=(0,i.createContext)(h.IDLE_LINK_STATUS),y=()=>(0,i.useContext)(v);("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),r.exports=t.default)},3374,e=>{"use strict";var r=e.i(43476),t=e.i(71645),n=e.i(22016),a=e.i(18566),o=e.i(54579),s=e.i(13741),i=e.i(59544),l=e.i(39964);function c(){let{user:e,logout:n}=(0,o.useAuth)(),[a,s]=(0,t.useState)(!1);if(!e)return null;let c=async()=>{try{await n(),s(!1)}catch(e){console.error("Error during logout:",e)}};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(i.Button,{variant:"ghost",className:"flex items-center gap-2 p-2",onClick:()=>s(!a),children:[e.photoURL?(0,r.jsx)("img",{src:e.photoURL,alt:e.displayName||"Usuario",className:"h-8 w-8 rounded-full"}):(0,r.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary-500 flex items-center justify-center text-white text-sm font-medium",children:(e.displayName||e.email||"U")[0].toUpperCase()}),(0,r.jsx)("span",{className:"hidden md:block text-sm",children:e.displayName||e.email}),(0,r.jsx)("svg",{className:`h-4 w-4 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>s(!1)}),(0,r.jsxs)(l.Card,{className:"absolute right-0 top-full mt-1 z-50 w-64 p-0",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[e.photoURL?(0,r.jsx)("img",{src:e.photoURL,alt:e.displayName||"Usuario",className:"h-10 w-10 rounded-full"}):(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-500 flex items-center justify-center text-white font-medium",children:(e.displayName||e.email||"U")[0].toUpperCase()}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium truncate",children:e.displayName||"Usuario"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.email})]})]})}),(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsxs)(i.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>{s(!1),window.location.href="/dashboard"},children:[(0,r.jsxs)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v0M8 5a2 2 0 012-2h4a2 2 0 012 2v0"})]}),"Panel de Control"]}),(0,r.jsxs)(i.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>{s(!1),window.location.href="/settings"},children:[(0,r.jsxs)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"ConfiguraciÃ³n"]}),(0,r.jsx)("div",{className:"border-t my-2"}),(0,r.jsxs)(i.Button,{variant:"ghost",className:"w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50",onClick:c,children:[(0,r.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Cerrar SesiÃ³n"]})]})]})]})]})}function u(){let{user:e}=(0,o.useAuth)(),l=(0,a.usePathname)(),[u,d]=(0,t.useState)(!1),f=[{href:"/",label:"Mapa",requiresAuth:!1},{href:"/dashboard",label:"Panel",requiresAuth:!0},{href:"/settings",label:"ConfiguraciÃ³n",requiresAuth:!0}].filter(r=>!r.requiresAuth||r.requiresAuth&&e);return(0,r.jsxs)("header",{className:"sticky top-0 z-50 w-full border-b border-primary-200/20 bg-white/95 backdrop-blur-xl supports-[backdrop-filter]:bg-white/80 shadow-soft",children:[(0,r.jsxs)("div",{className:"container flex h-18 items-center justify-between px-6",children:[(0,r.jsxs)(n.default,{href:"/",className:"flex items-center space-x-3 group",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 shadow-glow group-hover:shadow-lg transition-all duration-300",children:(0,r.jsx)("span",{className:"text-lg",children:"ðŸ›°ï¸"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-display font-bold text-xl bg-gradient-to-r from-primary-600 to-primary-800 bg-clip-text text-transparent",children:"Sentinel"}),(0,r.jsx)("div",{className:"text-xs text-primary-600/70 font-medium",children:"Monitoreo Global"})]})]}),(0,r.jsx)("nav",{className:"hidden md:flex items-center space-x-2",children:f.map(e=>(0,r.jsx)(n.default,{href:e.href,className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 hover:bg-primary-50 hover:text-primary-700 ${l===e.href?"bg-primary-100 text-primary-700 shadow-soft":"text-surface-600 hover:text-primary-600"}`,children:e.label},e.href))}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[e?(0,r.jsx)(c,{}):(0,r.jsx)(s.LoginButton,{}),(0,r.jsx)(i.Button,{variant:"ghost",size:"sm",className:"md:hidden",onClick:()=>d(!u),"aria-label":"Toggle menu",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u?(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),u&&(0,r.jsx)("div",{className:"md:hidden border-t bg-background",children:(0,r.jsx)("nav",{className:"container py-4 space-y-2",children:f.map(e=>(0,r.jsx)(n.default,{href:e.href,className:`block px-4 py-2 text-sm font-medium rounded-md transition-colors ${l===e.href?"bg-primary-100 text-primary-700":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"}`,onClick:()=>d(!1),children:e.label},e.href))})})]})}e.s(["Header",()=>u],3374)},28623,e=>{"use strict";e.i(36180);var r=e.i(98925),t=e.i(14985);async function n(e={disasterTypes:[],minSeverity:1}){try{let n=[];e.disasterTypes&&e.disasterTypes.length>0&&n.push((0,r.where)("disasterType","in",e.disasterTypes)),e.minSeverity&&e.minSeverity>1&&n.push((0,r.where)("severity",">=",e.minSeverity)),n.push((0,r.orderBy)("eventTime","desc")),n.push((0,r.limit)(100));let a=(0,r.query)((0,r.collection)(t.db,"events"),...n);return(await (0,r.getDocs)(a)).docs.map(e=>{let r=e.data(),t=r.location,n=t?.latitude??t?.lat,a=t?.longitude??t?.lng;return{id:e.id,...r,location:{lat:n,lng:a},eventTime:r.eventTime.toDate(),expiresAt:r.expiresAt?.toDate(),createdAt:r.createdAt.toDate(),updatedAt:r.updatedAt.toDate()}})}catch(e){throw console.error("Error getting events:",e),Error("Error al obtener eventos")}}async function a(e){try{let n=(0,r.doc)(t.db,"events",e),a=await (0,r.getDoc)(n);if(a.exists()){let e=a.data(),r=e.location,t=r?.latitude??r?.lat,n=r?.longitude??r?.lng;return{id:a.id,...e,location:{lat:t,lng:n},eventTime:e.eventTime.toDate(),expiresAt:e.expiresAt?.toDate(),createdAt:e.createdAt.toDate(),updatedAt:e.updatedAt.toDate()}}return null}catch(e){return console.error("Error getting event:",e),null}}function o(e,n={disasterTypes:[],minSeverity:1}){let a=[];n.disasterTypes&&n.disasterTypes.length>0&&a.push((0,r.where)("disasterType","in",n.disasterTypes)),n.minSeverity&&n.minSeverity>1&&a.push((0,r.where)("severity",">=",n.minSeverity)),a.push((0,r.orderBy)("eventTime","desc")),a.push((0,r.limit)(50));let s=(0,r.query)((0,r.collection)(t.db,"events"),...a);return(0,r.onSnapshot)(s,r=>{e(r.docs.map(e=>{let r=e.data(),t=r.location,n=t?.latitude??t?.lat,a=t?.longitude??t?.lng;return{id:e.id,...r,location:{lat:n,lng:a},eventTime:r.eventTime.toDate(),expiresAt:r.expiresAt?.toDate(),createdAt:r.createdAt.toDate(),updatedAt:r.updatedAt.toDate()}}))},e=>{console.error("Error subscribing to events:",e)})}async function s(e){try{let n=(0,r.query)((0,r.collection)(t.db,"users",e,"zones"),(0,r.orderBy)("createdAt","desc"));return(await (0,r.getDocs)(n)).docs.map(r=>{let t=r.data();return{id:r.id,userId:e,...t,location:{lat:t.location.latitude,lng:t.location.longitude},createdAt:t.createdAt.toDate()}})}catch(e){throw console.error("Error getting user zones:",e),Error("Error al obtener zonas")}}async function i(e,n){try{return(await (0,r.addDoc)((0,r.collection)(t.db,"users",e,"zones"),{...n,location:new r.GeoPoint(n.location.lat,n.location.lng),createdAt:r.Timestamp.now()})).id}catch(e){throw console.error("Error adding zone:",e),Error("Error al agregar zona")}}async function l(e,n,a){try{let o={...a};a.location&&(o.location=new r.GeoPoint(a.location.lat,a.location.lng)),await (0,r.updateDoc)((0,r.doc)(t.db,"users",e,"zones",n),o)}catch(e){throw console.error("Error updating zone:",e),Error("Error al actualizar zona")}}async function c(e,n){try{await (0,r.deleteDoc)((0,r.doc)(t.db,"users",e,"zones",n))}catch(e){throw console.error("Error deleting zone:",e),Error("Error al eliminar zona")}}e.s(["addUserZone",()=>i,"deleteUserZone",()=>c,"getEventById",()=>a,"getEvents",()=>n,"getUserZones",()=>s,"subscribeToEvents",()=>o,"updateUserZone",()=>l])},72881,e=>{"use strict";var r=e.i(43476),t=e.i(71645),n=e.i(70703),a=e.i(58594),o=e.i(59544);function s({onMyLocation:e,onToggleZones:n,showZones:a=!0,onFilterChange:s,className:i=""}){let[l,c]=(0,t.useState)(!1);return(0,r.jsxs)("div",{className:`absolute top-4 right-4 z-[1000] space-y-2 ${i}`,children:[(0,r.jsx)(o.Button,{size:"sm",variant:"subtle",className:"bg-surface border border-border shadow-lg hover:bg-accent",onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(r=>{e?.()},e=>{console.error("Error getting location:",e)}):console.error("Geolocation not supported")},title:"Mi ubicaciÃ³n",children:"ðŸ“"}),n&&(0,r.jsx)(o.Button,{size:"sm",variant:a?"solid":"subtle",className:"bg-surface border border-border shadow-lg",onClick:n,title:a?"Ocultar zonas":"Mostrar zonas",children:"ðŸ "}),(0,r.jsx)(o.Button,{size:"sm",variant:"subtle",className:"bg-surface border border-border shadow-lg",onClick:()=>c(!l),title:"Filtros",children:"ðŸ”"}),l&&(0,r.jsxs)("div",{className:"bg-surface border border-border rounded-lg p-3 shadow-lg min-w-[200px]",children:[(0,r.jsx)("h4",{className:"font-medium text-sm mb-3",children:"Filtros"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-muted-foreground block mb-1",children:"Severidad mÃ­nima"}),(0,r.jsxs)("select",{className:"w-full text-sm border border-border rounded px-2 py-1 bg-background",onChange:e=>s?.({minSeverity:parseInt(e.target.value)}),defaultValue:"1",children:[(0,r.jsx)("option",{value:"1",children:"Todas las severidades"}),(0,r.jsx)("option",{value:"2",children:"Severidad 2+"}),(0,r.jsx)("option",{value:"3",children:"Severidad 3+"}),(0,r.jsx)("option",{value:"4",children:"Solo severidad 4"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-muted-foreground block mb-1",children:"Tipo de desastre"}),(0,r.jsx)("div",{className:"space-y-1",children:[{value:"earthquake",label:"Sismos",icon:"ðŸŒ"},{value:"tsunami",label:"Tsunamis",icon:"ðŸŒŠ"},{value:"wildfire",label:"Incendios",icon:"ðŸ”¥"},{value:"flood",label:"Inundaciones",icon:"ðŸ’§"},{value:"storm",label:"Tormentas",icon:"ðŸŒ€"},{value:"volcano",label:"Volcanes",icon:"ðŸŒ‹"},{value:"landslide",label:"Deslizamientos",icon:"â›°ï¸"}].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)("input",{type:"checkbox",defaultChecked:!0,onChange:r=>{console.log(`${e.value}: ${r.target.checked}`)},className:"rounded border-border"}),(0,r.jsx)("span",{children:e.icon}),(0,r.jsx)("span",{children:e.label})]},e.value))})]})]}),(0,r.jsx)(o.Button,{size:"sm",className:"w-full mt-3",onClick:()=>c(!1),children:"Aplicar Filtros"})]}),(0,r.jsxs)("div",{className:"bg-surface border border-border rounded-lg p-3 shadow-lg",children:[(0,r.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Leyenda"}),(0,r.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-severity-4 rounded"}),(0,r.jsx)("span",{children:"Severidad 4"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-severity-3 rounded"}),(0,r.jsx)("span",{children:"Severidad 3"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-severity-2 rounded"}),(0,r.jsx)("span",{children:"Severidad 2"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-severity-1 rounded"}),(0,r.jsx)("span",{children:"Severidad 1"})]})]})]})]})}(0,n.default)(()=>e.A(52169).then(e=>e.MapContainer),{loadableGenerated:{modules:[94970]},ssr:!1});let i=(0,n.default)(()=>e.A(52169).then(e=>e.MapContainer),{loadableGenerated:{modules:[94970]},ssr:!1,loading:()=>(0,r.jsx)(a.LoadingSpinner,{text:"Cargando mapa..."})}),l=(0,n.default)(()=>e.A(52169).then(e=>e.TileLayer),{loadableGenerated:{modules:[94970]},ssr:!1}),c=(0,n.default)(()=>e.A(25e3).then(e=>({default:e.EventMarker})),{loadableGenerated:{modules:[94735]},ssr:!1}),u=(0,n.default)(()=>e.A(43144).then(e=>({default:e.ZoneCircle})),{loadableGenerated:{modules:[35692]},ssr:!1});function d({events:e,userZones:n=[],center:o=[-33.45,-70.65],zoom:d=5,height:f="400px",showControls:h=!0,showZones:p=!0,onEventClick:m,onZoneClick:g,onMyLocation:x,onToggleZones:v,onFilterChange:y,className:b=""}){let[j,w]=(0,t.useState)(!1),[N,k]=(0,t.useState)(p);return((0,t.useEffect)(()=>{w(!0)},[]),j)?(0,r.jsxs)("div",{className:`relative ${b}`,children:[(0,r.jsxs)(i,{center:o,zoom:d,style:{height:f,width:"100%"},className:"rounded-lg",children:[(0,r.jsx)(l,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),N&&n.map(e=>(0,r.jsx)(u,{zone:e,onClick:g},`zone-${e.id}`)),e.map(e=>(0,r.jsx)(c,{event:e,onClick:m},`event-${e.id}`))]}),h&&(0,r.jsx)(s,{onMyLocation:x,onToggleZones:()=>{k(!N),v?.()},showZones:N,onFilterChange:y})]}):(0,r.jsx)("div",{className:`bg-surface border border-border rounded-lg flex items-center justify-center ${b}`,style:{height:f},children:(0,r.jsx)(a.LoadingSpinner,{text:"Cargando mapa..."})})}e.s(["DisasterMap",()=>d],72881)},39313,e=>{"use strict";var r=e.i(71645),t=e.i(54579),n=e.i(28623);function a(){let{user:e}=(0,t.useAuth)(),[a,o]=(0,r.useState)([]),[s,i]=(0,r.useState)(!1),[l,c]=(0,r.useState)(null),u=e?.uid,d=(0,r.useCallback)(async()=>{if(!u)return void o([]);try{i(!0),c(null);let e=await (0,n.getUserZones)(u);o(e)}catch(e){console.error("Error loading zones:",e),c("Error al cargar zonas")}finally{i(!1)}},[u]);(0,r.useEffect)(()=>{d()},[d]);let f=(0,r.useCallback)(async e=>{if(!u)throw Error("Usuario no autenticado");try{c(null);let r=await (0,n.addUserZone)(u,e);return await d(),r}catch(e){throw console.error("Error creating zone:",e),c("Error al crear zona"),e}},[u,d]),h=(0,r.useCallback)(async(e,r)=>{if(!u)throw Error("Usuario no autenticado");try{c(null),await (0,n.updateUserZone)(u,e,r),await d()}catch(e){throw console.error("Error updating zone:",e),c("Error al actualizar zona"),e}},[u,d]),p=(0,r.useCallback)(async e=>{if(!u)throw Error("Usuario no autenticado");try{c(null),await (0,n.deleteUserZone)(u,e),await d()}catch(e){throw console.error("Error deleting zone:",e),c("Error al eliminar zona"),e}},[u,d]),m=(0,r.useCallback)(async(e,r)=>h(e,{isActive:r}),[h]),g=a.filter(e=>e.isActive),x=(0,r.useCallback)((e,r,t=0)=>g.some(n=>{var a,o,s,i;let l,c,u;return a=e,o=r,s=n.location.lat,i=n.location.lng,2*Math.atan2(Math.sqrt(u=Math.sin((l=(a-s)*Math.PI/180)/2)*Math.sin(l/2)+Math.cos(s*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin((c=(o-i)*Math.PI/180)/2)*Math.sin(c/2)),Math.sqrt(1-u))*6371<=n.radiusKm+t}),[g]);return{zones:a,activeZones:g,loading:s,error:l,createZone:f,updateZone:h,removeZone:p,toggleZone:m,refresh:d,isLocationInUserZones:x}}e.s(["useUserZones",()=>a])},96640,e=>{"use strict";let r,t;var n=e.i(43476),a=e.i(7670);let o=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=a.clsx;var i=e.i(91285);let l=(r="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",t={variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",severity1:"border-transparent bg-severity-1 text-white",severity2:"border-transparent bg-severity-2 text-white",severity3:"border-transparent bg-severity-3 text-white",severity4:"border-transparent bg-severity-4 text-white"}},defaultVariants:{variant:"default"}},e=>{var n;if((null==t?void 0:t.variants)==null)return s(r,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:a,defaultVariants:i}=t,l=Object.keys(a).map(r=>{let t=null==e?void 0:e[r],n=null==i?void 0:i[r];if(null===t)return null;let s=o(t)||o(n);return a[r][s]}),c=e&&Object.entries(e).reduce((e,r)=>{let[t,n]=r;return void 0===n||(e[t]=n),e},{});return s(r,l,null==t||null==(n=t.compoundVariants)?void 0:n.reduce((e,r)=>{let{class:t,className:n,...a}=r;return Object.entries(a).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...i,...c}[r]):({...i,...c})[r]===t})?[...e,t,n]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)});function c({className:e,variant:r,...t}){return(0,n.jsx)("div",{className:(0,i.cn)(l({variant:r}),e),...t})}e.s(["Badge",()=>c],96640)}]);