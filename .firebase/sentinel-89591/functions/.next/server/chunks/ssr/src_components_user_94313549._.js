module.exports=[47657,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(65488),e=a.i(46842),f=a.i(60305),g=a.i(96438),h=a.i(79530);let i=(0,c.forwardRef)(({isOpen:a,onClose:d,children:e,className:f},g)=>((0,c.useEffect)(()=>{let b=a=>{"Escape"===a.key&&d()};return a&&(document.addEventListener("keydown",b),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",b),document.body.style.overflow="unset"}},[a,d]),a)?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:d}),(0,b.jsx)("div",{ref:g,className:(0,h.cn)("relative z-10 max-h-[90vh] max-w-[90vw] overflow-auto rounded-lg bg-surface p-6 shadow-xl",f),onClick:a=>a.stopPropagation(),children:e})]}):null);i.displayName="Modal";let j=(0,c.forwardRef)(({children:a,className:c},d)=>(0,b.jsx)("div",{ref:d,className:(0,h.cn)("mb-4 flex items-center justify-between",c),children:a}));j.displayName="ModalHeader";let k=(0,c.forwardRef)(({children:a,className:c},d)=>(0,b.jsx)("h2",{ref:d,className:(0,h.cn)("text-lg font-semibold text-foreground",c),children:a}));k.displayName="ModalTitle";let l=(0,c.forwardRef)(({onClick:a,className:c},d)=>(0,b.jsx)("button",{ref:d,onClick:a,className:(0,h.cn)("rounded-full p-1 text-foreground hover:bg-accent focus:outline-none focus:ring-2 focus:ring-primary-500",c),"aria-label":"Cerrar modal",children:(0,b.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}));l.displayName="ModalCloseButton";var m=a.i(62067),n=a.i(5788);function o({initialData:a,onSubmit:d,onCancel:e,title:h}){let[i,o]=(0,c.useState)({name:a?.name||"",radiusKm:a?.radiusKm||50,location:a?.location||{lat:-33.45,lng:-70.65}}),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),v=(a,b)=>{let c=parseFloat(a),d=parseFloat(b);isNaN(c)||isNaN(d)||o(a=>({...a,location:{lat:c,lng:d}}))},w=async b=>{if(b.preventDefault(),!i.name.trim())return void alert("Por favor ingresa un nombre para la zona");if(i.radiusKm<1||i.radiusKm>500)return void alert("El radio debe estar entre 1 y 500 km");try{q(!0),await d({name:i.name.trim(),location:i.location,geohash:"",radiusKm:i.radiusKm,isActive:a?.isActive??!0})}catch(a){console.error("Error submitting form:",a)}finally{q(!1)}};return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)(j,{children:[(0,b.jsx)(k,{children:h}),(0,b.jsx)(l,{onClick:e})]}),(0,b.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,b.jsxs)(m.Card,{children:[(0,b.jsxs)(m.CardHeader,{children:[(0,b.jsx)(m.CardTitle,{className:"text-lg",children:"InformaciÃ³n BÃ¡sica"}),(0,b.jsx)(m.CardDescription,{children:"Configura el nombre y radio de la zona"})]}),(0,b.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Nombre de la zona *"}),(0,b.jsx)("input",{type:"text",value:i.name,onChange:a=>o(b=>({...b,name:a.target.value})),className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Ej: Mi casa, Trabajo, Ciudad...",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Radio de alerta (km) *"}),(0,b.jsx)("input",{type:"number",min:"1",max:"500",value:i.radiusKm,onChange:a=>o(b=>({...b,radiusKm:parseInt(a.target.value)||50})),className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"RecibirÃ¡s alertas cuando eventos ocurran dentro de este radio"})]})]})]}),(0,b.jsxs)(m.Card,{children:[(0,b.jsx)(m.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.CardTitle,{className:"text-lg",children:"UbicaciÃ³n"}),(0,b.jsx)(m.CardDescription,{children:"Selecciona el centro de la zona en el mapa"})]}),(0,b.jsx)(g.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{if(s(!0),u(null),!navigator.geolocation){u("La geolocalizaciÃ³n no estÃ¡ soportada por este navegador"),s(!1);return}navigator.geolocation.getCurrentPosition(a=>{let{latitude:b,longitude:c}=a.coords;o(a=>({...a,location:{lat:b,lng:c}})),s(!1)},a=>{console.error("Error getting location:",a);let b="Error al obtener la ubicaciÃ³n";switch(a.code){case a.PERMISSION_DENIED:b="Permiso de ubicaciÃ³n denegado";break;case a.POSITION_UNAVAILABLE:b="UbicaciÃ³n no disponible";break;case a.TIMEOUT:b="Tiempo de espera agotado"}u(b),s(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},disabled:r,children:r?(0,b.jsx)(n.LoadingSpinner,{size:"sm"}):"ðŸ“ Mi ubicaciÃ³n"})]})}),(0,b.jsx)(m.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[t&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:t}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Latitud"}),(0,b.jsx)("input",{type:"number",step:"0.000001",value:i.location.lat,onChange:a=>v(a.target.value,i.location.lng.toString()),className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"-33.456789"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Longitud"}),(0,b.jsx)("input",{type:"number",step:"0.000001",value:i.location.lng,onChange:a=>v(i.location.lat.toString(),a.target.value),className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"-70.678901"})]})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ðŸ“ UbicaciÃ³n actual: ",i.location.lat.toFixed(6),", ",i.location.lng.toFixed(6)]}),(0,b.jsx)("div",{className:"h-64 rounded-lg overflow-hidden border",children:(0,b.jsx)(f.DisasterMap,{events:[],center:[i.location.lat,i.location.lng],zoom:12,onEventClick:()=>{},onZoneClick:()=>{}})}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:'ðŸ’¡ Puedes ajustar las coordenadas manualmente o usar "Mi ubicaciÃ³n" para centrar el mapa en tu posiciÃ³n actual'})]})})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Cancelar"}),(0,b.jsxs)(g.Button,{type:"submit",disabled:p,className:"flex-1",children:[p?(0,b.jsx)(n.LoadingSpinner,{size:"sm"}):null,a?"Actualizar Zona":"Crear Zona"]})]})]})]})}var p=a.i(55486);function q({zone:a,onEdit:c,onDelete:d,onToggle:e,className:f=""}){let h;return(0,b.jsx)(m.Card,{className:`${a.isActive?"border-primary-500 bg-primary-50/50":""} ${f}`,children:(0,b.jsx)(m.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg",children:a.name}),(0,b.jsx)(p.Badge,{variant:a.isActive?"secondary":"outline",children:a.isActive?"Activa":"Inactiva"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-muted-foreground",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"ðŸ“ Radio:"})," ",a.radiusKm," km"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"ðŸ“… Creada:"})," ",(h=a.createdAt,new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"short",year:"numeric"}).format(h))]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"ðŸ“ UbicaciÃ³n:"})," ",a.location.lat.toFixed(4),", ",a.location.lng.toFixed(4)]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,b.jsx)(g.Button,{size:"sm",variant:a.isActive?"default":"outline",onClick:e,className:"min-w-[80px]",children:a.isActive?"Desactivar":"Activar"}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",onClick:c,children:"âœï¸ Editar"}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",onClick:d,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"ðŸ—‘ï¸ Eliminar"})]})]})})})}function r({className:a=""}){let{user:f}=(0,d.useAuth)(),{zones:h,loading:j,error:k,createZone:l,updateZone:p,removeZone:r,toggleZone:s}=(0,e.useUserZones)(),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),x=async a=>{try{await l(a),u(!1)}catch(a){console.error("Error creating zone:",a)}},y=async a=>{if(v)try{await p(v.id,a),w(null)}catch(a){console.error("Error updating zone:",a)}},z=async a=>{if(confirm("Â¿EstÃ¡s seguro de que quieres eliminar esta zona?"))try{await r(a)}catch(a){console.error("Error deleting zone:",a)}};return f?(0,b.jsxs)("div",{className:a,children:[(0,b.jsxs)(m.Card,{children:[(0,b.jsx)(m.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.CardTitle,{children:"Mis Zonas de Monitoreo"}),(0,b.jsx)(m.CardDescription,{children:"Configura las Ã¡reas geogrÃ¡ficas donde quieres recibir alertas"})]}),(0,b.jsx)(g.Button,{onClick:()=>u(!0),children:"âž• Agregar Zona"})]})}),(0,b.jsx)(m.CardContent,{children:j?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)(n.LoadingSpinner,{text:"Cargando zonas..."})}):k?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"text-red-500 mb-2",children:"âš ï¸ Error al cargar zonas"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:k}),(0,b.jsx)(g.Button,{variant:"outline",size:"sm",className:"mt-4",onClick:()=>window.location.reload(),children:"Reintentar"})]}):0===h.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ—ºï¸"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No tienes zonas configuradas"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"Crea tu primera zona para empezar a recibir alertas personalizadas"}),(0,b.jsx)(g.Button,{onClick:()=>u(!0),children:"Crear Primera Zona"})]}):(0,b.jsx)("div",{className:"space-y-4",children:h.map(a=>(0,b.jsx)(q,{zone:a,onEdit:()=>w(a),onDelete:()=>z(a.id),onToggle:()=>s(a.id,!a.isActive)},a.id))})})]}),(0,b.jsx)(i,{isOpen:t,onClose:()=>u(!1),children:(0,b.jsx)(o,{onSubmit:x,onCancel:()=>u(!1),title:"Crear Nueva Zona"})}),(0,b.jsx)(i,{isOpen:!!v,onClose:()=>w(null),children:v&&(0,b.jsx)(o,{initialData:v,onSubmit:y,onCancel:()=>w(null),title:"Editar Zona"})})]}):(0,b.jsx)(m.Card,{className:a,children:(0,b.jsx)(m.CardContent,{className:"text-center py-8",children:(0,b.jsx)("div",{className:"text-muted-foreground",children:"Debes iniciar sesiÃ³n para gestionar tus zonas"})})})}a.s(["ZoneManager",()=>r],47657)},43912,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(65488),e=a.i(86645),f=a.i(62067),g=a.i(96438),h=a.i(55486),i=a.i(5788);function j({className:a=""}){let{user:j}=(0,d.useAuth)(),[k,l]=(0,c.useState)({}),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{if(j?.uid)try{n(!0);let a={};e.DISASTER_TYPES.forEach(b=>{a[b]={disasterType:b,minSeverity:1,pushEnabled:!0,emailEnabled:!1}}),l(a)}catch(a){console.error("Error loading preferences:",a)}finally{n(!1)}})()},[j?.uid]);let q=async(a,b,c)=>{try{p(a),l(d=>({...d,[a]:{...d[a],[b]:c}})),await new Promise(a=>setTimeout(a,500))}catch(a){console.error("Error updating preference:",a)}finally{p(null)}};return j?m?(0,b.jsx)(f.Card,{className:a,children:(0,b.jsx)(f.CardContent,{className:"text-center py-8",children:(0,b.jsx)(i.LoadingSpinner,{text:"Cargando preferencias..."})})}):(0,b.jsxs)(f.Card,{className:a,children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(f.CardTitle,{children:"Preferencias de Alertas"}),(0,b.jsx)(f.CardDescription,{children:"Configura quÃ© tipos de desastres quieres monitorear y cÃ³mo recibir las alertas"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Button,{variant:"outline",size:"sm",onClick:()=>{e.DISASTER_TYPES.forEach(a=>{k[a]?.pushEnabled||q(a,"pushEnabled",!0)})},children:"Activar Todas"}),(0,b.jsx)(g.Button,{variant:"outline",size:"sm",onClick:()=>{e.DISASTER_TYPES.forEach(a=>{k[a]?.pushEnabled&&q(a,"pushEnabled",!1)})},children:"Desactivar Todas"})]})]})}),(0,b.jsxs)(f.CardContent,{children:[(0,b.jsx)("div",{className:"space-y-4",children:e.DISASTER_TYPES.map(a=>{let c=e.DISASTER_CONFIGS[a],d=k[a],f=o===a;return d?(0,b.jsxs)("div",{className:"border border-border rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)("span",{className:"text-2xl",children:c.icon}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold",children:c.nameEs}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:c.name})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Severidad mÃ­n."}),(0,b.jsx)("select",{value:d.minSeverity,onChange:b=>q(a,"minSeverity",parseInt(b.target.value)),disabled:f,className:"text-sm border border-border rounded px-2 py-1 disabled:opacity-50",children:[1,2,3,4].map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Push"}),(0,b.jsx)("input",{type:"checkbox",checked:d.pushEnabled,onChange:b=>q(a,"pushEnabled",!d.pushEnabled),disabled:f,className:"w-4 h-4 text-primary-600 border-border rounded focus:ring-primary-500"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Email"}),(0,b.jsx)("input",{type:"checkbox",checked:d.emailEnabled,onChange:b=>q(a,"emailEnabled",!d.emailEnabled),disabled:f,className:"w-4 h-4 text-primary-600 border-border rounded focus:ring-primary-500"})]}),(0,b.jsx)("div",{className:"text-right",children:f?(0,b.jsx)(i.LoadingSpinner,{size:"sm"}):(0,b.jsx)(h.Badge,{variant:d.pushEnabled?"secondary":"outline",children:d.pushEnabled?"Activo":"Inactivo"})})]})]}),(0,b.jsxs)("div",{className:"mt-3 pt-3 border-t",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-2",children:"Niveles de severidad:"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(c.severityLabels).map(([a,c])=>(0,b.jsx)(h.Badge,{variant:parseInt(a)>=d.minSeverity?"outline":"secondary",className:"text-xs",children:c},a))})]})]},a):null})}),(0,b.jsxs)("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"ðŸ’¡ Consejos"}),(0,b.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1",children:[(0,b.jsxs)("li",{children:["â€¢ ",(0,b.jsx)("strong",{children:"Severidad mÃ­nima:"})," Solo recibirÃ¡s alertas para eventos de esta severidad o superior"]}),(0,b.jsxs)("li",{children:["â€¢ ",(0,b.jsx)("strong",{children:"Notificaciones push:"})," Alertas en tiempo real en tu dispositivo"]}),(0,b.jsxs)("li",{children:["â€¢ ",(0,b.jsx)("strong",{children:"Notificaciones email:"})," ResÃºmenes diarios por correo electrÃ³nico"]}),(0,b.jsx)("li",{children:"â€¢ Puedes ajustar estas preferencias en cualquier momento"})]})]})]})]}):(0,b.jsx)(f.Card,{className:a,children:(0,b.jsx)(f.CardContent,{className:"text-center py-8",children:(0,b.jsx)("div",{className:"text-muted-foreground",children:"Debes iniciar sesiÃ³n para gestionar tus preferencias de alertas"})})})}a.s(["AlertPreferences",()=>j])}];

//# sourceMappingURL=src_components_user_94313549._.js.map